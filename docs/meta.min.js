/*
 Copyright (c) 2016 Rolando González Chévere <rolosworld@gmail.com>
 
 This file is part of Meta.
 
 Meta is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License version 3
 as published by the Free Software Foundation.
 
 Meta is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 
 You should have received a copy of the GNU General Public License
 along with Meta.  If not, see <http://www.gnu.org/licenses/>.
*/
(function(z){var v=!!z.ActiveXObject,A={name:"Meta",author:"Rolando Gonz\u00e1lez, rolosworld@gmail.com",version:"2017.12.03"},d=z.Meta=function(){function a(a){var b=d(),f=d.its(a,"function")?a:a.constructor,b=b.constructor,g;f&&(b.prototype=new f);for(g in a)a.hasOwnProperty(g)&&(b.prototype[g]=a[g]);return b}function b(b){function e(){this.constructor=e;this.$new=function(){return new e};this.info=A;this.extend=function(a,h){var b=["$super","extend","info"];h=h||{};h.exclude=h.exclude?h.exclude.concat(b): b;return d.inherit(this,a,h)}}var f;void 0!==b&&(f=a(b));f&&(e.prototype=new f);e.prototype.$super=function(a){if(f){var h,b=this.$super;h=f.prototype;this.$super=h.$super;h=h[a].apply(this,d.args2array(arguments,1));this.$super=b;return h}};return e}return function(a){return new (b(a))}}();d.extensions={};d.son=function(a){function b(){}b.prototype=a;b.prototype.constructor=b;return new b};d.extend=function(a,b,c){c=c||[];for(var e in b)"constructor"!=e&&a!=b[e]&&0>d.indexOf(c,e)&&(a[e]=b[e]);return a}; d.inherit=function(a,b,c){var e=[],f=[],g={};c&&(f=c.exclude||f,e=c.params||e);"function"==typeof b&&(b.apply(g,e),b=g);c=a.constructor;d.extend(c?c.prototype:a,b,f);return a};d.each=function(a,b,c){var e;if(!c)for(e=0,c=a.length;e<c;e++){if(!1===b.call(a,a[e],e))return!1}else for(e in a)if(!1===b.call(a,a[e],e))return!1;return!0};d.its=function(a,b){var c=typeof a;if(b==c)return!0;"object"==c||"function"==c?c=a?a.nodeType?"element":Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1].toLowerCase(): "null":"number"==c&&(isNaN(a)?c="nan":isFinite(a)||(c=0<a?"infinite":"-infinite"));return b?b==c:c};d.args2array=function(a,b){if(v){var c=[];d.each(a,function(a,d){d>=b&&c.push(a)});return c}return Array.prototype.slice.call(a,b)};d.obj2array=function(a,b){if(b||v){var c=[];d.each(a,function(a){c.push(a)},b);return c}return Array.prototype.slice.call(a)};d.indexOf=function(a,b,c){for(var e=a.length;e--;)if(!c){if(a[e]===b)break}else if(a[e]==b)break;return e};d.unique=function(a){var b=[],c,e;c= 0;for(e=a.length;c<e;c++)0>d.indexOf(b,a[c])&&b.push(a[c]);return b};d.has=function(a,b){return a&&void 0!==a[b]&&null!==a[b]};d.genProperties=function(a,b,c){var e=0;a=a.split(",");for(var d=a[0];e<a.length;d=a[++e])c[d]=b(d)};d.toggle=function(a,b,c){c=c||!1;return function(){return((c=!c)?a:b).apply(this,arguments)}};d.getVal=function(a,b){a=a.split(".");for(var c=b||window,e;void 0!==(e=a.shift())&&(c=c[e],c););return c};d.hashToURI=function(a){var b=[],c;d.each(Object.keys(a),function(e){c=a[e]; b.push(encodeURIComponent(e,1)+"="+encodeURIComponent(null===c||void 0===c?"":c,1))});return b.join("&")};d.ajax=function(a){var b,c,e=a.callbacks;b=a.method?a.method:b;c=a.headers?a.headers:c;var f=v?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest,g={status:function(){return f.status},text:function(){return f.responseText},json:function(){return JSON.parse(f.responseText)},xml:function(){return f.responseXML}},h=d.its(e,"array");f.open(b||"GET",a.url,!0);f.onreadystatechange=function(){if(e){var a= f.readyState;h||4!=a?e[a]&&e[a].call(g,g):e.call(g,g)}};if(c)for(var k in c)f.setRequestHeader(k,c[k]);f.send(a.data);return f};d.ajax.async=!0;d.core=d().extend({_:null,$:function(a){return this.$new().set(a)},its:function(a){return d.its(this._,a)},get:function(){return this._},set:function(a){this._=a;return this},wrap:function(a,b){return this._[a].apply(this._,b)},copy:function(){return this.$().set(this.get())},callback:function(a){var b=this,c=d.args2array(arguments,1);return function(){return b[a].apply(b, c)}},getMe:function(){return this}});d.queue=d(d.core).extend({cnt:null,started:0,increase:function(){this.cnt++},decrease:function(){!--this.cnt&&this.started&&this._()},start:function(){this.started=1;this.cnt||this._()}});d.string=d(d.core).extend({_:"",$:function(a){return this.$new().set(a||"")},set:function(a){return this.$super("set",""+a)},len:function(){return this.get().length},dos2unix:function(){return this.replace(/\r\n|\r/g,"\n")},unix2dos:function(){return this.replace(/\n/g,"\r\n")}, toCamelCase:function(a){a=this.split(a);for(var b=1,c=a.length,e;b<c;b++)e=a[b],a[b]=e.charAt(0).toUpperCase(),a[b]+=e.substr(1);return a.join("")},stripTags:function(){return this.replace(/<\/?[^>]+>/g,"")},escapeHTML:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;")},unescapeHTML:function(){var a=document.createElement("div");a.innerHTML=this.stripTags().get();return this.set(a.childNodes[0]?a.childNodes[0].nodeValue: "")},trim:function(){return this.replace(/^\s+|\s+$/g,"")},rtrim:function(){return this.replace(/\s+$/,"")},ltrim:function(){return this.replace(/^\s+/,"")},insertAt:function(a,b){var c=this.get();return this.set(c.substr(0,a)+b+c.substr(a))},addSlashes:function(){return this.replace(/\\/g,"\\\\").replace(/\'/g,"\\'")},stripSlashes:function(){return this.replace(/\\'/g,"'").replace(/\\\\/g,"\\")},nl2br:function(){return this.dos2unix().replace(/\n/g,"<br/>")},br2nl:function(){return this.replace(/<br\s*\/?>/gi, "\n")},isInt:function(){return null!==this.get().match(/^\d+$/g)},hasInt:function(){return null!==this.get().match(/\d/g)},toInt:function(){return parseInt(this.get().match(/\d/g).join(""),10)}}).extend(function(){var a=d.genProperties;a("replace,concat,substr,substring,slice,toUpperCase,toLowerCase",function(a){return function(){return this.set(this.wrap(a,arguments))}},this);a("charAt,charCodeAt,indexOf,lastIndexOf,search,match,split,valueOf",function(a){return function(){return this.wrap(a,arguments)}}, this)});d.array=d(d.core).extend({_:[],$:function(){var a=this.$new(),b;a.set([]);d.each(arguments,function(c){b=d.its(c);"array"==b?a.set(c):"undefined"!=b&&a.push(c)});return a},get:function(a){var b=this.$super("get");return d.its(a,"number")?b[a]:b},set:function(a,b){d.its(b,"number")?this.get()[b]=a:(d.its(a,"array")||(a=[a]),this.$super("set",a));return this},indexOf:function(a,b){var c=this.get(),e=c.length;for(b=b||0;b<e;b++)if(c[b]===a)return b;return-1},lastIndexOf:function(a,b){for(var c= this.get(),e=b+1||c.length;e--&&c[e]!==a;);return e},some:function(a,b){b=b||this;var c=this.get();return!d.each(c,function(e,d){if(a.call(b,e,d,c))return!1})},every:function(a,b){b=b||this;var c=this.get();return d.each(c,function(e,d){if(!a.call(b,e,d,c))return!1})},filter:function(a,b){b=b||this;var c=[],e=this.get();d.each(e,function(d,g){a.call(b,d,g,e)&&c.push(d)});return c},forEach:function(a,b){b=b||this;var c=this.get();d.each(c,function(e,d){a.call(b,e,d,c)});return this},map:function(a, b){b=b||this;var c=[],e=this.get();d.each(e,function(d,g){c.push(a.call(b,d,g,e))});return c},numSort:function(){return this.sort(function(a,b){return a-b})},insert:function(a,b){void 0==b?this.push(a):this.splice(b,0,a);return this},drop:function(a,b){return this.splice(a,b||1)},unique:function(){return this.set(d.unique(this.get()))},len:function(){return this.get().length},reduce:function(a,b){var c=this.len(),e=0,d=this.get();for(b=b||d[e++];e<c;e++)b=a.call(this,b,d[e],e,d);return b},reduceRight:function(a, b){var c=this.len(),e=c-1,d=this.get();if(!(1>c)||b){for(c=b||d[e--];0<=e;e--)c=a.call(this,c,d[e],e,d);return c}},shuffle:function(){for(var a=this.get(),b=a.length,c=b-1,e,d;b--;)e=Math.round(Math.random()*c),d=a[b],a[b]=a[e],a[e]=d;return this}}).extend(function(){var a=d.genProperties;a("push,sort,splice,unshift,reverse",function(a){return function(){this.wrap(a,arguments);return this}},this);a("pop,shift,join",function(a){return function(){return this.wrap(a,arguments)}},this);a("concat,slice", function(a){return function(){return this.set(this.wrap(a,arguments))}},this)});d.events=d(d.core).extend(function(){var a=d.array.$();this.events={};this.onNewEvent=function(){};this.onEmptyEvent=function(){};this.onFireEvent=function(){};this.addEvent=function(b,c,e){var f=-1,g=this;g.events[b]?f=g.indexOfEvent(b,c):g.events[b]=[];0>f?(f={type:b,obj:c,cb:function(){return g.fireEvent.apply(g,a.set([b,c]).concat(d.obj2array(arguments)).get())},fn:[]},g.events[b].push(f),g.onNewEvent(f)):f=g.events[b][f]; a.set(f.fn);d.its(e,"array")?(a.concat(e),f.fn=a.get()):a.push(e);return g};this.getEvent=function(a,c){var e=this.events[a];return e&&e[c]?e[c]:null};this.getObjectEvents=function(a){var c=[],e,d;for(d in this.events)e=this.indexOfEvent(d,a),-1<e&&c.push(this.events[d][e]);return c};this.indexOfEvent=function(b,c){var e=-1;if(!this.events[b])return e;a.set(this.events[b]).every(function(a,b){return a.obj==c?(e=b,!1):!0});return e};this.fireEvent=function(a,c){var e=this.indexOfEvent(a,c),f=!0,g; if(0>e)return!1;e=this.events[a][e];g=[];d.each(arguments,function(a,b){1<b&&g.push(a)});d.each(e.fn,function(a){!1===a.apply(c,g)&&(f=!1)});this.onFireEvent(e,f,g);return f};this.rmEvent=function(b,c,e){var d=-1,g,h=this.indexOfEvent(b,c);if(0>h)return this;c=this.events[b][h];e?(g=a.set(c.fn),d=g.indexOf(e),-1<d&&g.drop(d)):c.fn=[];c.fn.length||(a.set(this.events[b]).drop(h),this.onEmptyEvent(c));return this};this.rmObject=function(a){var c=this;d.each(c.events,function(d,f){c.rmEvent(f,a)},1); return c};this.flush=function(a){a=a||function(){return 1};var c=this,e=[],f;d.each(c.events,function(d,h){for(f=d.length;f--;)a(h,d[f].obj)&&c.rmEvent(h,d[f].obj);d.length||e.push(h)},1);for(f=e.length;f--;)delete c.events[e[f]];return c};this.on=function(a,c){return this.addEvent(a,this,c)};this.off=function(a,c){return this.rmEvent(a,this,c)};this.fire=function(a,c){return this.fireEvent(a,this,c)}});d.jsonrpc=d(d(d.events).extend(d.array)).extend({events:{},url:function(a){this._url=a;return this}, send:function(a,b){this.fire("send");d.ajax({url:this._url,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(a),callbacks:b});return this},push:function(a){this.$super("push",a);this.fire(a.method);return this},execute:function(a){var b=[],c,d,f=this;if(f.len())return f.forEach(function(a,h){c={jsonrpc:"2.0",method:a.method};a.params&&(c.params=a.params);a.callback&&(c.id=h);b.push(c)}),d=f._,f._=[],f.send(b,function(b){f.$(b.json()).forEach(function(a){var b=d[a.id];b.callback(a)? f.fire(b.method+":TRUE"):f.fire(b.method+":FALSE")});d=null;a&&a()}),f}});d.eventtarget=d(d.events).extend({valid_type:"",wrapped:function(a){return-1!=this.valid_type.indexOf(" "+a+" ")},onNewEvent:function(a){this.wrapped(a.type)&&(d.has(a.obj,"addEventListener")?a.obj.addEventListener(a.type,a.cb,!1):d.has(a.obj,"attachEvent")&&a.obj.attachEvent("on"+a.type,a.cb))},onEmptyEvent:function(a){this.wrapped(a.type)&&(d.has(a.obj,"removeEventListener")?a.obj.removeEventListener(a.type,a.cb,!1):d.has(a.obj, "detachEvent")&&a.obj.detachEvent("on"+a.type,a.cb))},on:function(a,b){var c=this.wrapped(a)?this.get():this;if(b)return this.addEvent(a,c,b)},fire:function(a,b){var c=this.wrapped(a)?this.get():this;return this.fireEvent(a,c,b)},off:function(a,b){var c=this.wrapped(a)?this.get():this;return this.rmEvent(a,c,b)}});d.domevent=d(d.eventtarget).extend(d.array).extend({valid_type:" abort blur change click dblclick error focus keydown keypress keyup load mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend reset resize select submit unload hashchange ", onFireEvent:function(a,b,c){!b&&this.wrapped(a.type)&&(c[0].cancelBubble=!0,c[0].returnValue=!1,c[0].stopPropagation&&c[0].stopPropagation(),c[0].preventDefault&&c[0].preventDefault())},on:function(a,b){var c=this;if(b)return c.forEach(function(d){c.addEvent(a,d,b)})},fire:function(a){var b=this;return b.forEach(function(c){if(c["on"+a])c["on"+a]();b.fireEvent(a,c)})},off:function(a,b){var c=this;return c.forEach(function(d){c.rmEvent(a,d,b)})},cleanEvents:function(){return this.flush(function(a, b){return null===b.parentNode})}});d.domevent.addEvent("unload",window,function(){d.events.flush();document&&document.body&&d.dom.purge(document.body)});d.select=function(){return function(a,b){b=b||document;return d.obj2array(b.querySelectorAll(a))}}();d.sandbox=function(){var a=document.createElement("iframe"),b,c;a.style.display="none";document.body.appendChild(a);c=frames[frames.length-1];b=c.document;b.writeln("<script>window.sandbox=window.ActiveXObject?this:{eval:function(s){return eval(s)}};\x3c/script>"); b.close();return{eval:function(a){return c.sandbox.eval(a)},include:function(a){var c=b.createElement("script");c.src=a;b.body.appendChild(c)}}};d.dom=d(d.domevent).extend(function(){function a(a){"float"==a&&(a=v?"styleFloat":"cssFloat");return d.string.$(a).toCamelCase("-")}var b={before:function(a,b,c){c&&c.insertBefore(b,a)},after:function(a,b,c){c&&c.insertBefore(b,a.nextSibling)},replace:function(a,b,c){c&&c.replaceChild(b,a)},prepend:function(a,b){a.insertBefore(b,a.firstChild||null)},append:function(a, b){a.appendChild(b)}},c=d.string.$(),e=d.array.$(),f,g;return{info:{name:"Meta.dom"},_doc:document,$:function(){var a=["$"],b=arguments;b.length?a=a.concat(d.args2array(b)):a.push(this.doc());return this.$super.apply(this,a)},set:function(a,b){return this.$super("set",a||this.doc(),b)},doc:function(a){if(!a)return this._doc=this._doc||document;if(!d.its(a,"string"))return this._doc=9==a.nodeType?a:a.ownerDocument?a.ownerDocument:document,this;v?(this._doc=new ActiveXObject("Msxml2.DOMDocument"),this._doc.async= !1,this._doc.loadXML(a)):this._doc=(new DOMParser).parseFromString(a,"text/xml");this.set(d.obj2array(this._doc.childNodes));return this},select:function(a){var b=[],c=d.select;this.len()?this.forEach(function(d){b=b.concat(c(a,d))}):b=c(a,this.doc());return this.$(b)},evalGlobal:function(a){var b=this.doc(),c=b.createElement("script"),d=b.getElementsByTagName("head")[0]||b.documentElement;c.type="text/javascript";v?c.text=a:c.appendChild(b.createTextNode(a));d.insertBefore(c,d.firstChild);d.removeChild(c); return this},glue:function(a,c){if(""===a)return this;var m,p=this,f=b[c||"append"],g=p.$(),q=e.$(),u=e.$();a.nodeType?g.set(a):"string"==typeof a?g=g.create(a):g.set(a);m=p.doc().createDocumentFragment();g.forEach(function(a){"script"==a.nodeName.toLowerCase()?q.push(a):1==a.nodeType&&q.concat(d.obj2array(a.getElementsByTagName("script")));m.appendChild(a)});q.forEach(function(a){a.src||(u.push(a.text||a.textContent||a.innerHTML||""),a.parentNode.removeChild(a))});u=u.join("\n");p.forEach(function(a, b){f(a,b?m.cloneNode(!0):m,a.parentNode);u&&p.evalGlobal(u)});return p},remove:function(){for(var a=this._,b=a.length,c;b--;)c=a[b],c.parentNode&&c.parentNode.removeChild(c);return this},create:function(a){var b=[],c,e=this.doc().createElement("div");c=d.string.$(a);var n,l;a=c.trim().get();n=c.substr(c.lastIndexOf("<"));l=n.indexOf(" ");0>l&&(l=n.indexOf(">"));n="|"+n.substr(2,l-2).get()+"|";0>c.set("|caption|colgroup|col|thead|tfoot|tbody|tr|th|td|").indexOf(n)&&(n=0);this.isXML(e)?(c=g,c||(f=d.sandbox(), c=g=f.eval('document.createElement("div");')),c.innerHTML=a,d.dom.copyNodes(c.childNodes,e)):(n&&(a="|tr|"==n?"<table><tbody>"+a+"</tbody></table>":c.set("|th|td|").indexOf(n)?"<table><tbody><tr>"+a+"</tr></tbody></table>":"<table>"+a+"</table>"),v?(e.innerHTML=n?a:"<br>"+a,e.removeChild(e.firstChild)):e.innerHTML=a,n&&(e=e.firstChild,"|tr|"==n?e=e.firstChild:c.set("|th|td|").indexOf(n)&&(e=e.firstChild.firstChild)));for(;c=e.firstChild;)b.push(e.removeChild(c));return this.$(b)},prop:function(a, b){return(b=this.get(b||0))?a in b?b[a]:null:b},attr:function(a,b){var c,d=this._;c=d.length;var e,f;if(!c)return null;e=d[0];f=e.attributes;if(!a)return f;if(void 0!==b){for(;c--;)null===b&&d[c].removeAttribute?d[c].removeAttribute(a):d[c].setAttribute(a,b);return this}return f?e.getAttribute(a):null},data:function(a,b){var c=this._,e=d.string.$(a).toCamelCase("-"),f=c.length;if(void 0===b)return f?c[0].dataset[e]:null;for(;f--;)c[f].dataset[e]=b;return this},css:function(b,c){var d=this._,e=d.length; b=a(b);if(void 0===c)return e?d[0].style[b]:null;for(;e--;)d[e].style[b]=c;return this},style:function(b,c){if(c=this.get(c||0))b=a(b),c=window.getComputedStyle?window.getComputedStyle(c,null).getPropertyValue(b):c.currentStyle[b];return c},_values:function(a){if("SELECT"==a.nodeName){if(a.multiple){a=a.options;var b=[];for(i in a)a[i].selected&&b.push(a[i].value);return b}return a.options[a.selectedIndex].value}return a.value||null},val:function(a){var b,c=[],e,f=this._,g=f.length,q=d.indexOf;if(void 0!== a){for(;g--;)if(b=f[g],"SELECT"==b.nodeName)for(a.push||(a=[a]),e=b.options,b=e.length;b--;)c=e[b],c.selected=!1,-1<q(a,c.value,1)&&(c.selected=!0);else b.value=a;return this}if(!g)return null;if(1==g)return this._values(f[0]);for(b=0;b<g;b++)c.push(this._values(f[b]));return c},outer:function(a){var b=this._,c=b.length,d;a=b[a||0];if(!a||!a.nodeType)return null;if(3==a.nodeType)return a.nodeValue;if(!v){if(this.isXML(a))return(new XMLSerializer).serializeToString(a);b=this.doc().createElement("b"); b.appendChild(a);return b.innerHTML}b=this.isXML(a)?"xml":"outerHTML";if(11!=a.nodeType)d=a[b];else{d=[];a=a.childNodes;for(c=a.length;c--;)d.push(a[c][b]);d.reverse();d=d.join("")}return d},inner:function(a,b){var c=this._,d,e="",f,g;if(void 0===a){if(!c.length)return null;d=c[0];if(!this.isXML(d))return d.innerHTML;c=this.$();d=d.childNodes;f=0;for(g=d.length;f<g;f++)e+=c.set(d[f]).outer();return e}this.empty().append(a,b);return this},text:function(a){if(void 0===a){a=this._;if(!a.length)return null; a=a[0];return a.text||a.textContent||(a.innerHTML?a.innerHTML.replace(/<\/?[^>]+>/gi,""):"")}this.empty().append(this.doc().createTextNode(a));return this},elements:function(a){var b=this._;if(!b.length)return null;var c=[],d=b[0];if("FORM"!=d.nodeName.toUpperCase())return null;d=d.elements;for(b=d.length;b--;)if(void 0===a)c.push(c[d[b].name]=d[b]);else if(d[b].name==a)return d[b];return a?null:c},submit:function(a){var b=this._;if(!b.length)return this;a=a||function(){};for(var c=this.elements(), e=this.$(),f=[],g=0,q,u,r;g<c.length;g++)r=c[g],"FIELDSET"!=r.nodeName.toUpperCase()&&("INPUT"!=r.nodeName.toUpperCase()||"checkbox"!=r.type.toLowerCase()&&"radio"!=r.type.toLowerCase()||r.checked)&&(q=e.set(r).val(),u=encodeURIComponent(r.name,1)+"=",d.its(q,"array")?d.each(q,function(a){f.push(u+encodeURIComponent(null===a||void 0===a?"":a,1))}):f.push(u+encodeURIComponent(null===q||void 0===q?"":q,1)));d.ajax({url:b[0].action,callbacks:a,method:"POST",data:f.join("&")});return this},nodes:function(a){var b= this._,c=[],d=b.length;a=a||0;if(d<=a)return null;d=b[a].childNodes;b=d.length;for(a=0;a<b;a++)1==d[a].nodeType&&c.push(d[a]);return c},empty:function(){for(var a,b=this._,c=b.length,d=this.isXML();c--;)if(a=b[c],d)for(;a.firstChild;)a.removeChild(a.firstChild);else a.innerHTML="";return this},hasClass:function(a,b){var c=this._,d=c.length;b=b||0;if(d<=b)return!1;b=c[b];return b.className?-1<(" "+b.className+" ").indexOf(" "+a+" "):!1},addClass:function(a){for(var b=this._,d=b.length,f;d--;)f=b[d], "className"in f&&(f.className=c.set(e.set(f.className.split(" ")).insert(a).unique().get().join(" ")).trim().get());return this},rmClass:function(a){for(var b=this._,d=b.length,f,g,l;d--;)f=b[d],f.className&&(g=e.set(f.className.split(" ")).unique(),l=g.indexOf(a),-1<l&&(f.className=c.set(g.splice(l,1).get().join(" ")).trim().get()));return this},dims:function(a){if(a=this.get(a||0)){for(var b=a.offsetLeft||0,c=a.offsetTop||0,d=a.offsetWidth||0,e=a.offsetHeight||0;a=a.offsetParent;)b+=a.offsetLeft- a.scrollLeft+(a.clientLeft?a.clientLeft:0),c+=a.offsetTop-a.scrollTop+(a.clientTop?a.clientTop:0);a={left:b,top:c,width:d,height:e}}return a},scrollDims:function(a){return(a=this.get(a||0))?{left:a.scrollX||a.scrollLeft,top:a.scrollY||a.scrollTop,width:a.scrollWidth||0,height:a.scrollHeight||0}:a},opacity:function(a){var b=Math.round(100*a);return this.css("MozOpacity",a).css("opacity",a).css("KHTMLOpacity",a).css("zoom",1).css("filter","alpha(opacity="+b+")")},hide:function(){return this.css("display", "none")},show:function(a){return this.css("display",a||"")},parent:function(a){return this.$(this.prop("parentNode",a))},next:function(a){for(a=this.get(a||0);a&&(a=a.nextSibling)&&1!=a.nodeType;);return this.$(a)},prev:function(a){for(a=this.get(a||0);a&&(a=a.previousSibling)&&1!=a.nodeType;);return this.$(a)},first:function(a){for(a=this.prop("firstChild",a);a&&1!=a.nodeType;)a=a.nextSibling;return this.$(a)},last:function(a){for(a=this.prop("lastChild",a);a&&1!=a.nodeType;)a=a.previousSibling; return this.$(a)},value:function(a){return this.prop("nodeValue",a)},type:function(a){return this.prop("nodeType",a)},name:function(a){return this.prop("nodeName",a)},isXML:function(a){a||(a=this.doc());a=9==a.nodeType?a:a.ownerDocument;return"HTML"!==a.documentElement.nodeName}}}()).extend(function(){d.genProperties("prepend,append,before,after,replace",function(a){return function(b){return this.glue(b,a)}},this)}).extend(function(){var a={prependTo:"prepend",appendTo:"append",insertBefore:"before", insertAfter:"after",replaceIn:"replace"};d.genProperties("prependTo,appendTo,insertBefore,insertAfter,replaceIn",function(b){return function(c){var d=this._;return this.set(c).glue(d,a[b]).set(d)}},this)});d.dom.copyNodes=function(a,b,c,e){var f=b.ownerDocument?b.ownerDocument:9==b.nodeType?b:document,g=function(a,b){for(var c,d=0,g=b.length;d<g;d++)1==b[d].nodeType?c=a.appendChild(h(b[d])):3==b[d].nodeType&&a.appendChild(f.createTextNode(b[d].nodeValue)),e==b[d]&&(e=c)},h=function(a){c&&a&&!a.id&& d.has(a,"uniqueID")&&(a.id=a.uniqueID);var b=d.dom.cloneTag(a);g(b,a.childNodes);return b};g(b,a);return e};d.dom.cloneTag=function(a,b){b=b||(a.ownerDocument?a.ownerDocument:document);var c=b.createElement(a.nodeName.toLowerCase()),d,f;d=a.attributes;for(f=d.length;f--;)c.setAttribute(d[f].name,d[f].value);return c};d.dom.cloneNode=function(a,b){b=b||(a.ownerDocument?a.ownerDocument:document);if(3==a.nodeType)return b.createTextNode(a.nodeValue);var c=d.dom.cloneTag(a,b);d.dom.copyNodes(a.childNodes, c);return c};d.dom.ready=function(){var a=0,b,c,e=d.events.$(),f;e.extend({fireReady:function(){a||(a=1,this.fireEvent("ready",window),c&&clearInterval(c))}});f=e.callback("fireReady");d.has(document,"addEventListener")?document.addEventListener("DOMContentLoaded",f,!1):d.has(window,"ActiveXObject")?(b=document.createElement("script"),b.onreadystatechange=function(){/loaded|complete/.test(b.readyState)&&(f(),b.onreadystatechange=null)},b.defer=!0,b.src="javascript:void(0);",document.getElementsByTagName("HEAD")[0].appendChild(b)): /Safari/i.test(navigator.userAgent)&&(c=setInterval(function(){/loaded|complete/.test(document.readyState)&&f()},10));d.dom.addEvent("load",window,f);return function(b){a?b():e.addEvent("ready",window,b)}}();d.dom.purge=function(a){if(v||a.attributes){var b=a.attributes,c,e;if(b)for(c=b.length;c--;)e=b[c].name,"function"===typeof a[e]&&(a[e]=null);if(b=a.childNodes)for(c=b.length;c--;)d.dom.purge(b[c])}};d.websocketevent=d(d.eventtarget).extend({valid_type:" open message error close "});d.websocket= d(d.websocketevent).extend({connect:function(a){this.set(new WebSocket(a));this.fire("connect");return this},close:function(){this.get().close();this.fire("close");return this},send:function(a){var b=JSON.stringify(a);this.get().send(b);this.fire("send",a);return this}});d.cookie=d(d.core).extend({create:function(a){var b=this.get()+"="+a.value,c;for(c in a)"value"!=c&&(b+=";"+c+"="+a[c]);document.cookie=b},read:function(){for(var a=document.cookie.split(";"),b,c=a.length;c--;)if(b=a[c].replace(/^\s*|\s*$/g, "").split("="),b[0]==this.get())return decodeURIComponent(b[1]);return null},erase:function(){var a=new Date;a.setDate(a.getDate()-9);this.create({value:"","max-age":0,expire:a.toUTCString()})}});d.popup=function(a){a=a||{};a.src=a.src||"";var b=b=window.open(a.src,a.name||(a.name="meta"+(new Date).getTime()),a.params||"");""==a.src&&b&&b.document&&(b.document.writeln(a.write||'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\n<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>'+ (a.title||a.name)+"</title></head><body></body></html>"),b.document.close());b||(b=null);return b};d.log=function(){var a=null,b=d.dom.$(),c=d.string.$(),e=d.dom.$();d.dom.addEvent("unload",window,function(){a&&!a.closed&&a.close()});return function(f){if(!a||a.closed)a=d.popup({title:"Meta.log",params:"width=400,height=400,location=0,menubar=0,status=0,toolbar=0,directories=0,personalbar=0,resizable=1,scrollbars=1,dependent=1"});if(!a||!a.document||!a.document.body||a.closed)return a=null;b.set(a.document.body).doc(a.document); b.append('<div style="border-bottom:1px solid #ccc;padding:4px;font-size:12px;font-family:arial;">'+c.set(f).trim().escapeHTML().nl2br().get()+"</div>");0>d.log.buff&&e.set(b.get().firstChild).doc(b.doc()).remove();a.scrollBy(0,b.dims().height);a.focus();return a}}();d.log.buff=100;d.assert=function(a,b){var c=d.assert;c.log&&d.log(a+" = "+b);if(!0!==b&&!1!==b)c.onfail("Unexpected value: "+b);if(b)c.onpass(a);else c.onfail(a)};d.assert.log=!1;d.assert.onfail=function(){};d.assert.onpass=function(){}; d.guiEngine=d(function(){function a(){"meta_sel"in n&&(p.css("MozUserSelect",n.meta_MozUserSelect),p.css("KhtmlUserSelect",n.meta_KhtmlUserSelect),p.get().onselectstart=n.meta_onselectstart,p.get().unselectable=n.meta_unselectable)}function b(){"meta_sel"in n||(n.meta_sel=1,n.meta_onselectstart=p.get().onselectstart,n.meta_unselectable=p.get().unselectable,n.meta_MozUserSelect=p.css("MozUserSelect"),n.meta_KhtmlUserSelect=p.css("KhtmlUserSelect"));p.get().onselectstart=function(){return!1};p.get().unselectable= "on";p.css("MozUserSelect","none").css("KhtmlUserSelect","none")}function c(a){if(!r||!h.len())return!1;a=a?a:window.event;var b=[a.screenX-u[0],a.screenY-u[1]];"mmv"in w[r]&&w[r].mmv(a,b);a.cancelBubble=!0;return!1}function e(a){a=a?a:window.event;h.set(a.target||a.srcElement);r=h.attr("gui");if(!(r in w))return!1;var b=h.attr("dad"),c=h.attr("limit");b&&h.select("#"+b);c?k.select("#"+c):k.set(p.get());g();"md"in w[r]&&w[r].md(a);u=[a.screenX,a.screenY];a.cancelBubble=!0;return!1}function f(a){if(!r)return!1; a=a?a:window.event;"mu"in w[r]&&w[r].mu(a);u=[a.screenX,a.screenY];a.cancelBubble=!0;r="";return!1}function g(){var a=k.dims();l=[a.left,a.top,t.width+a.left,t.height+a.top]}var h=d.dom.$(),k=d.dom.$(),m=d.domevent.$(document),p,n={},l=[0,0,0,0],q={left:0,top:0,width:0,height:0},u=[0,0],r="",x=0,w={drag:{md:function(a){q=h.dims();b();h.css("position","absolute").css("zIndex","1")},mu:function(b){a();h.css("zIndex","0")},mmv:function(a,b){var c=q,d=[l[2]-s[0],l[3]-s[1]];b=[c.left+b[0],c.top+b[1]]; b[0]>=l[0]&&b[0]<d[0]?(c.left=b[0],u[0]=a.screenX):b[0]<l[0]?b[0]=l[0]:b[0]>d[0]&&(b[0]=d[0]);b[1]>=l[1]&&b[1]<d[1]?(c.top=b[1],u[1]=a.screenY):b[1]<l[1]?b[1]=l[1]:b[1]>d[1]&&(b[1]=d[1]);h.css("left",b[0]+"px");h.css("top",b[1]+"px")}},resize:{md:function(a){b()},mu:function(b){a()},mmv:function(a,b){var c=h.dims();b=[c.width+b[0],c.height+b[1]];10<=b[0]&&(h.css("width",b[0]+"px"),u[0]=a.screenX);10<=b[1]&&(h.css("height",b[1]+"px"),u[1]=a.screenY)}}};return{guiStart:function(){x||(m.on("mousemove", c).on("mousedown",e).on("mouseup",f),x=1,p=d.dom.$().set(document.body),k.set(p.get()),g())},guiStop:function(){x&&(m.off("mousemove",c).off("mousedown",e).off("mouseup",f),x=0)},guiEngine:function(){return x}}}());d.animation=function(){function a(a,c,d,e,m,p){e=parseInt(e,10);var n=(new Date).getTime(),l=n+(e||200),q=d-c,u=l-n,r=this;b.addEvent("frameStep",b,function(){var a=(new Date).getTime();if(a>=l)return!1;m.call(p,c+(a-n)*q/u)});b.addEvent("stopAnim",b,function(){a&&a.call(r,p)});b.fireEvent("frameStep", b)}var b=d.events.$(),c=1E3/30,e="clip position width height left top display visibility overflow filter MozOpacity zoom opacity KHTMLOpacity".split(" ");b.onFireEvent=function(a,d){"frameStep"==a.type&&(d?setTimeout(b.callback("fireEvent","frameStep",b),c):(b.rmEvent("frameStep",b),b.fireEvent("stopAnim",b),b.rmEvent("stopAnim",b)))};return d.son({data_meta:"data-meta_",cssBackup:function(){var a=d.dom.$(),b,c=this;return c.forEach(function(k){a.set(k);k=parseInt(a.attr(c.data_meta+"bak"),10)||0; a.attr(c.data_meta+"bak",k+1);k||(d.each(e,function(d){b=a.css(d);null!==b&&a.attr(c.data_meta+d,b)}),a.attr(c.data_meta+"size_w")||(b=a.dims(),a.attr(c.data_meta+"size_w",b.width).attr(c.data_meta+"size_h",b.height)),a.attr(c.data_meta+"pos_l")||(b=a.dims(),a.attr(c.data_meta+"pos_l",b.left).attr(c.data_meta+"pos_t",b.top)))})},cssRestore:function(a){function b(a){k=c.attr(m.data_meta+a);c.css(a,"");null!==k&&c.css(a,k)}var c=d.dom.$(),k,m=this;return m.forEach(function(k){c.set(k).attr(m.data_meta+ "bak")&&(a?b(a):d.each(e,b))})},cssBackupClear:function(){var a=d.dom.$(),b=this;return b.forEach(function(c){a.set(c);d.each(e,function(c){a.attr(b.data_meta+c,null)});a.attr(b.data_meta+"bak",null).attr(b.data_meta+"size_w",null).attr(b.data_meta+"size_h",null).attr(b.data_meta+"pos_l",null).attr(b.data_meta+"pos_t",null)})},animate:function(c,d,e,k,m,p,n){var l=this;l.cssBackup();l.cssRestore("display");l.__||b.addEvent("stopAnim",b,function(){n&&(l.cssRestore(),l.cssBackupClear());l.__=0});l.__= 1;return this.forEach(function(b){k&&k(b);a.call(l,p,c.call(b),d.call(b),e,m,b)})}})}();d.inherit(d.animation,{clip:function(a,b,c){var e=d.dom.$(),f=this,g,h,k,m=function(){return 0},p=function(){return e.set(this).dims().width},n=function(){return e.set(this).dims().height},l=function(){return 1},q=function(a,b,c,d){e.css("clip","rect("+a+"px "+b+"px "+c+"px "+d+"px)")};[function(){g=m;h=n;k=function(a){e.set(this);var b=e.dims();q(a,b.width,b.height,0)}},function(){g=p;h=m;k=function(a){e.set(this); var b=e.dims();q(0,a,b.height,0)}},function(){g=n;h=m;k=function(a){e.set(this);var b=e.dims();q(0,b.width,a,0)}},function(){g=m;h=p;k=function(a){e.set(this);var b=e.dims();q(0,b.width,b.height,a)}},function(){g=m;h=n;k=function(a){e.set(this);var b=e.dims();q(a,b.width,b.height-a,0)}},function(){g=m;h=p;k=function(a){e.set(this);var b=e.dims();q(0,b.width-a,b.height,a)}},function(){g=m;h=l;k=function(a){e.set(this);var b=e.dims(),c=a*b.width;a*=b.height;q(a,b.width-c,b.height-a,c)}},function(){g= m;h=l;k=function(a){e.set(this);var b=e.dims();q(b.height*a,b.width-a*b.width,b.height,0)}},function(){g=m;h=l;k=function(a){e.set(this);var b=e.dims();q(0,b.width,b.height-b.height*a,a*b.width)}},function(){g=m;h=l;k=function(a){e.set(this);var b=e.dims();q(b.height*a,b.width,b.height,a*b.width)}},function(){g=m;h=l;k=function(a){e.set(this);var b=e.dims();q(0,b.width-a*b.width,b.height-b.height*a,0)}},function(){g=m;h=l;k=function(a){e.set(this);var b=e.dims(),c=b.height*a;q(c,b.width-a*b.width, b.height-c,0)}},function(){g=m;h=l;k=function(a){e.set(this);var b=e.dims(),c=a*b.width;q(b.height*a,b.width-c,b.height,c)}},function(){g=m;h=l;k=function(a){e.set(this);var b=e.dims(),c=b.height*a;q(c,b.width,b.height-c,a*b.width)}},function(){g=m;h=l;k=function(a){e.set(this);var b=e.dims(),c=a*b.width;q(0,b.width-c,b.height-b.height*a,c)}}][a]();return this.animate(g,h,b,function(a){e.set(a).css("overflow","hidden").css("position","absolute")},k,function(a){e.set(a).hide();c&&c.call(f,a)})}}); d.inherit(d.animation,{fade:function(a,b,c){var e=this,f=d.dom.$(),g,h;g=function(){return 0};var k=function(){return 1},m=function(a){c&&c.call(e,a)},p=function(a){f.set(a).hide();c&&c.call(e,a)};"out"==a?(a=k,m=p):(a=g,g=k,h=1);return this.animate(a,g,b,null,function(a){f.set(this).opacity(a)},m,h)}});d.inherit(d.animation,{slide:function(a,b,c){var e=this,f=d.dom.$(),g,h,k,m,p=function(){return 0},n=function(){return f.set(this).dims().width},l=function(){return f.set(this).dims().height},q=function(){return 1}, u=function(a){f.set(this).css("width",a+"px")},r=function(a){f.set(this).css("height",a+"px")},v=function(a){f.set(this);var b=[f.attr(e.data+"size_w"),f.attr(e.data+"size_h")];f.css("width",a*b[0]+"px").css("height",a*b[1]+"px")},w=function(a){c&&c.call(e,a)},y=function(a){f.set(a).hide();c&&c.call(e,a)};({"up-left":function(){g=q;h=p;k=v;w=y},right:function(){g=p;h=n;k=u;m=1},left:function(){g=n;h=p;k=u;w=y},up:function(){g=l;h=p;k=r;w=y},down:function(){g=p;h=l;k=r;m=1},"down-right":function(){g= p;h=q;k=v;m=1}})[a]();return e.animate(g,h,b,function(a){f.set(a).css("overflow","hidden")},k,w,m)}});d.dom.extend(d.animation)})(window);
