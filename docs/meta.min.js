/*
 Copyright (c) 2016 Rolando González Chévere <rolosworld@gmail.com>
 
 This file is part of Meta.
 
 Meta is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License version 3
 as published by the Free Software Foundation.
 
 Meta is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 
 You should have received a copy of the GNU General Public License
 along with Meta.  If not, see <http://www.gnu.org/licenses/>.
*/
(function(E){var w=!!E.ActiveXObject,J={name:"Meta",author:"Rolando Gonz\u00e1lez, rolosworld@gmail.com",version:"2016.06.22"},e=E.Meta=function(){function a(a){var b=e(),h=e.its(a,"function")?a:a.constructor,b=b.constructor,f;h&&(b.prototype=new h);for(f in a)a.hasOwnProperty(f)&&(b.prototype[f]=a[f]);return b}function b(b){function d(){this.constructor=d;this.$new=function(){return new d};this.info=J;this.extend=function(a,g){var b=["$super","extend","info"];g=g||{};g.exclude=g.exclude?g.exclude.concat(b): b;return e.inherit(this,a,g)}}var h;void 0!==b&&(h=a(b));h&&(d.prototype=new h);d.prototype.$super=function(a){if(h){var g,b=this.$super;g=h.prototype;this.$super=g.$super;g=g[a].apply(this,e.args2array(arguments,1));this.$super=b;return g}};return d}return function(a){return new (b(a))}}();e.extensions={};e.son=function(a){function b(){}b.prototype=a;b.prototype.constructor=b;return new b};e.extend=function(a,b,c){c=c||[];for(var d in b)"constructor"!=d&&a!=b[d]&&0>e.indexOf(c,d)&&(a[d]=b[d]);return a}; e.inherit=function(a,b,c){var d=[],h=[],f={};c&&(h=c.exclude||h,d=c.params||d);"function"==typeof b&&(b.apply(f,d),b=f);c=a.constructor;e.extend(c?c.prototype:a,b,h);return a};e.each=function(a,b,c){var d;if(!c)for(d=0,c=a.length;d<c;d++){if(!1===b.call(a,a[d],d))return!1}else for(d in a)if(!1===b.call(a,a[d],d))return!1;return!0};e.its=function(a,b){var c=typeof a;if(b==c)return!0;"object"==c||"function"==c?c=a?a.nodeType?"element":Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1].toLowerCase(): "null":"number"==c&&(isNaN(a)?c="nan":isFinite(a)||(c=0<a?"infinite":"-infinite"));return b?b==c:c};e.args2array=function(a,b){if(w){var c=[];e.each(a,function(a,e){e>=b&&c.push(a)});return c}return Array.prototype.slice.call(a,b)};e.obj2array=function(a,b){if(b||w){var c=[];e.each(a,function(a){c.push(a)},b);return c}return Array.prototype.slice.call(a)};e.indexOf=function(a,b,c){for(var d=a.length;d--;)if(!c){if(a[d]===b)break}else if(a[d]==b)break;return d};e.unique=function(a){var b=[],c,d;c= 0;for(d=a.length;c<d;c++)0>e.indexOf(b,a[c])&&b.push(a[c]);return b};e.has=function(a,b){return a&&void 0!==a[b]&&null!==a[b]};e.genProperties=function(a,b,c){var d=0;a=a.split(",");for(var e=a[0];d<a.length;e=a[++d])c[e]=b(e)};e.toggle=function(a,b,c){c=c||!1;return function(){return((c=!c)?a:b).apply(this,arguments)}};e.getVal=function(a,b){a=a.split(".");for(var c=b||window,d;void 0!==(d=a.shift())&&(c=c[d],c););return c};e.hashToURI=function(a){var b=[],c;e.each(Object.keys(a),function(d){c=a[d]; b.push(encodeURIComponent(d,1)+"="+encodeURIComponent(null===c||void 0===c?"":c,1))});return b.join("&")};e.ajax=function(a){var b,c,d=a.callbacks;b=a.method?a.method:b;c=a.headers?a.headers:c;var h=w?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest,f={status:function(){return h.status},text:function(){return h.responseText},json:function(){return JSON.parse(h.responseText)},xml:function(){return h.responseXML}},g=e.its(d,"array");h.open(b||"GET",a.url,!0);h.onreadystatechange=function(){if(d){var a= h.readyState;g||4!=a?d[a]&&d[a].call(f,f):d.call(f,f)}};if(c)for(var k in c)h.setRequestHeader(k,c[k]);h.send(a.data);return h};e.ajax.async=!0;e.core=e().extend({_:null,$:function(a){return this.$new().set(a)},its:function(a){return e.its(this._,a)},get:function(){return this._},set:function(a){this._=a;return this},wrap:function(a,b){return this._[a].apply(this._,b)},copy:function(){return this.$().set(this.get())},callback:function(a){var b=this,c=e.args2array(arguments,1);return function(){return b[a].apply(b, c)}},getMe:function(){return this}});e.string=e(e.core).extend({_:"",$:function(a){return this.$new().set(a||"")},set:function(a){return this.$super("set",""+a)},len:function(){return this.get().length},dos2unix:function(){return this.replace(/\r\n|\r/g,"\n")},unix2dos:function(){return this.replace(/\n/g,"\r\n")},toCamelCase:function(a){a=this.split(a);for(var b=1,c=a.length,d;b<c;b++)d=a[b],a[b]=d.charAt(0).toUpperCase(),a[b]+=d.substr(1);return a.join("")},stripTags:function(){return this.replace(/<\/?[^>]+>/g, "")},escapeHTML:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;")},unescapeHTML:function(){var a=document.createElement("div");a.innerHTML=this.stripTags().get();return this.set(a.childNodes[0]?a.childNodes[0].nodeValue:"")},trim:function(){return this.replace(/^\s+|\s+$/g,"")},rtrim:function(){return this.replace(/\s+$/,"")},ltrim:function(){return this.replace(/^\s+/,"")},insertAt:function(a,b){var c=this.get();return this.set(c.substr(0, a)+b+c.substr(a))},addSlashes:function(){return this.replace(/\\/g,"\\\\").replace(/\'/g,"\\'")},stripSlashes:function(){return this.replace(/\\'/g,"'").replace(/\\\\/g,"\\")},nl2br:function(){return this.dos2unix().replace(/\n/g,"<br/>")},br2nl:function(){return this.replace(/<br\s*\/?>/gi,"\n")},hasInt:function(){return null!==this.get().match(/\d/g)},toInt:function(){return parseInt(this.get().match(/\d/g).join(""),10)}}).extend(function(){var a=e.genProperties;a("replace,concat,substr,substring,slice,toUpperCase,toLowerCase", function(a){return function(){return this.set(this.wrap(a,arguments))}},this);a("charAt,charCodeAt,indexOf,lastIndexOf,search,match,split,valueOf",function(a){return function(){return this.wrap(a,arguments)}},this)});e.array=e(e.core).extend({_:[],$:function(){var a=this.$new(),b;a.set([]);e.each(arguments,function(c){b=e.its(c);"array"==b?a.set(c):"undefined"!=b&&a.push(c)});return a},get:function(a){var b=this.$super("get");return e.its(a,"number")?b[a]:b},set:function(a,b){e.its(b,"number")?this.get()[b]= a:(e.its(a,"array")||(a=[a]),this.$super("set",a));return this},indexOf:function(a,b){var c=this.get(),d=c.length;for(b=b||0;b<d;b++)if(c[b]===a)return b;return-1},lastIndexOf:function(a,b){for(var c=this.get(),d=b+1||c.length;d--&&c[d]!==a;);return d},some:function(a,b){b=b||this;var c=this.get();return!e.each(c,function(d,e){if(a.call(b,d,e,c))return!1})},every:function(a,b){b=b||this;var c=this.get();return e.each(c,function(d,e){if(!a.call(b,d,e,c))return!1})},filter:function(a,b){b=b||this;var c= [],d=this.get();e.each(d,function(e,f){a.call(b,e,f,d)&&c.push(e)});return c},forEach:function(a,b){b=b||this;var c=this.get();e.each(c,function(d,e){a.call(b,d,e,c)});return this},map:function(a,b){b=b||this;var c=[],d=this.get();e.each(d,function(e,f){c.push(a.call(b,e,f,d))});return c},numSort:function(){return this.sort(function(a,b){return a-b})},insert:function(a,b){void 0==b?this.push(a):this.splice(b,0,a);return this},drop:function(a,b){return this.splice(a,b||1)},unique:function(){return this.set(e.unique(this.get()))}, len:function(){return this.get().length},reduce:function(a,b){var c=this.len(),d=0,e=this.get();for(b=b||e[d++];d<c;d++)b=a.call(this,b,e[d],d,e);return b},reduceRight:function(a,b){var c=this.len(),d=c-1,e=this.get();if(!(1>c)||b){for(c=b||e[d--];0<=d;d--)c=a.call(this,c,e[d],d,e);return c}},shuffle:function(){for(var a=this.get(),b=a.length,c=b-1,d,e;b--;)d=Math.round(Math.random()*c),e=a[b],a[b]=a[d],a[d]=e;return this}}).extend(function(){var a=e.genProperties;a("push,sort,splice,unshift,reverse", function(a){return function(){this.wrap(a,arguments);return this}},this);a("pop,shift,join",function(a){return function(){return this.wrap(a,arguments)}},this);a("concat,slice",function(a){return function(){return this.set(this.wrap(a,arguments))}},this)});e.events=e(e.core).extend(function(){var a=e.array.$();this.events={};this.onNewEvent=function(){};this.onEmptyEvent=function(){};this.onFireEvent=function(){};this.addEvent=function(b,c,d){var h=-1,f=this;f.events[b]?h=f.indexOfEvent(b,c):f.events[b]= [];0>h?(h={type:b,obj:c,cb:function(){return f.fireEvent.apply(f,a.set([b,c]).concat(e.obj2array(arguments)).get())},fn:[]},f.events[b].push(h),f.onNewEvent(h)):h=f.events[b][h];a.set(h.fn);e.its(d,"array")?(a.concat(d),h.fn=a.get()):a.push(d);return f};this.getEvent=function(a,c){var d=this.events[a];return d&&d[c]?d[c]:null};this.getObjectEvents=function(a){var c=[],d,e;for(e in this.events)d=this.indexOfEvent(e,a),-1<d&&c.push(this.events[e][d]);return c};this.indexOfEvent=function(b,c){var d= -1;if(!this.events[b])return d;a.set(this.events[b]).every(function(a,b){return a.obj==c?(d=b,!1):!0});return d};this.fireEvent=function(a,c){var d=this.indexOfEvent(a,c),h=!0,f;if(0>d)return!1;d=this.events[a][d];f=[];e.each(arguments,function(a,b){1<b&&f.push(a)});e.each(d.fn,function(a){!1===a.apply(c,f)&&(h=!1)});this.onFireEvent(d,h,f);return h};this.rmEvent=function(b,c,d){var e=-1,f,g=this.indexOfEvent(b,c);if(0>g)return this;c=this.events[b][g];d?(f=a.set(c.fn),e=f.indexOf(d),-1<e&&f.drop(e)): c.fn=[];c.fn.length||(a.set(this.events[b]).drop(g),this.onEmptyEvent(c));return this};this.rmObject=function(a){var c=this;e.each(c.events,function(d,e){c.rmEvent(e,a)},1);return c};this.flush=function(a){a=a||function(){return 1};var c=this,d=[],h;e.each(c.events,function(e,g){for(h=e.length;h--;)a(g,e[h].obj)&&c.rmEvent(g,e[h].obj);e.length||d.push(g)},1);for(h=d.length;h--;)delete c.events[d[h]];return c};this.on=function(a,c){return this.addEvent(a,this,c)};this.off=function(a,c){return this.rmEvent(a, this,c)};this.fire=function(a,c){return this.fireEvent(a,this,c)}});e.jsonrpc=e(e(e.events).extend(e.array)).extend({events:{},url:function(a){this._url=a;return this},send:function(a,b){this.fire("send");e.ajax({url:this._url,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(a),callbacks:b});return this},push:function(a){this.$super("push",a);this.fire(a.method);return this},execute:function(){var a=[],b,c,d=this;if(d.len())return d.forEach(function(c,d){b={jsonrpc:"2.0", method:c.method};c.params&&(b.params=c.params);c.callback&&(b.id=d);a.push(b)}),c=d._,d._=[],d.send(a,function(a){d.$(a.json()).forEach(function(a){var g=c[a.id];g.callback(a)?d.fire(g.method+":TRUE"):d.fire(g.method+":FALSE")});c=null}),d}});e.eventtarget=e(e.events).extend({valid_type:"",wrapped:function(a){return-1!=this.valid_type.indexOf(" "+a+" ")},onNewEvent:function(a){this.wrapped(a.type)&&(e.has(a.obj,"addEventListener")?a.obj.addEventListener(a.type,a.cb,!1):e.has(a.obj,"attachEvent")&& a.obj.attachEvent("on"+a.type,a.cb))},onEmptyEvent:function(a){this.wrapped(a.type)&&(e.has(a.obj,"removeEventListener")?a.obj.removeEventListener(a.type,a.cb,!1):e.has(a.obj,"detachEvent")&&a.obj.detachEvent("on"+a.type,a.cb))},on:function(a,b){var c=this.wrapped(a)?this.get():this;if(b)return this.addEvent(a,c,b)},fire:function(a,b){var c=this.wrapped(a)?this.get():this;return this.fireEvent(a,c,b)},off:function(a,b){var c=this.wrapped(a)?this.get():this;return this.rmEvent(a,c,b)}});e.domevent= e(e.eventtarget).extend(e.array).extend({valid_type:" abort blur change click dblclick error focus keydown keypress keyup load mousedown mousemove mouseout mouseover mouseup reset resize select submit unload hashchange ",onFireEvent:function(a,b,c){!b&&this.wrapped(a.type)&&(c[0].cancelBubble=!0,c[0].returnValue=!1,c[0].stopPropagation&&c[0].stopPropagation(),c[0].preventDefault&&c[0].preventDefault())},on:function(a,b){var c=this;if(b)return c.forEach(function(d){c.addEvent(a,d,b)})},fire:function(a){var b= this;return b.forEach(function(c){if(c["on"+a])c["on"+a]();b.fireEvent(a,c)})},off:function(a,b){var c=this;return c.forEach(function(d){c.rmEvent(a,d,b)})},cleanEvents:function(){return this.flush(function(a,b){return null===b.parentNode})}});e.domevent.addEvent("unload",window,function(){e.events.flush();document&&document.body&&e.dom.purge(document.body)});e.select=function(){function a(a,g,b){var c,d=0;if(a)for(c in d=1,g)if(g[c]&&!b[c](a,g[c])){d=0;break}return d}var b=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]+['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[]+)+|[>+~])(\s*,\s*)?/g, c=/#((?:[\w\u00c0-\uFFFF_-]|\\.)+)/g,d=/\.((?:[\w\u00c0-\uFFFF_-]|\\.)+)/g,h=/\[\s*((?:[\w\u00c0-\uFFFF_-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/g,f=/^((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)/g,g={"=":function(a,g){return a==g},"!=":function(a,g){return a!=g},"~=":function(a,g){return null!==a&&-1<(" "+a+" ").indexOf(g)},"^=":function(a,g){return null!==a&&0==a.indexOf(g)},"*=":function(a,g){return null!==a&&-1<a.indexOf(g)},"$=":function(a,g){return null!==a&&a.lastIndexOf(g)+g.length==a.length},"|=":function(a, g){return a==g||0==a.indexOf(g+"-")},"":function(a,g){return null!==a}},k={tag:function(a,g){return a.nodeName==g||"*"==g},className:function(a,g){var b=a.className;return b&&-1<(" "+b+" ").indexOf(" "+g+" ")},attr:function(a,g){for(var b,c,d=g.length;d--;){c=g[d];b=c[1];if(1==a.nodeType&&(b=a.getAttribute(b),null!==b&&c[2](b,c[4])))continue;return 0}return 1},pseudo:function(){return 0},nest:function(a,g){var b=g[0],c=g[1],d;return a?b[parseInt(a.getAttribute(c),10)]!=a?(d=b.length,a.setAttribute(c, d),b[d]=a,1):0:0}},p={">":function(a,g,b,c,d,e,k){g=a.childNodes;var p=[];b=0;for(c=g.length;b<c;b++)a=g[b],1==a.nodeType&&e(a,d,k)&&p.push(a);return p},"~":function(a,g,b,c,d,e,k){for(g=[];a=a.nextSibling;)1==a.nodeType&&e(a,d,k)&&g.push(a);return g},"+":function(a,g,b,c,d,e,k){for(;(a=a.nextSibling)&&1!=a.nodeType;);return e(a,d,k)?[a]:[]}};return function(q,m){m=m||document;if(m.querySelectorAll)return e.obj2array(m.querySelectorAll(q));var n,l,r,u,z,v=[m],C=9==m.nodeType?m:m.ownerDocument,A,F, G,x,w,B,E="HTML"!==C.documentElement.nodeName,D,I=0,H=[],y={};for(b.lastIndex=0;n=b.exec(q);)if(u=n[1],">"==u||"~"==u||"+"==u)z=p[u];else{D=[];c.lastIndex=0;if(l=c.exec(u))x=C.getElementById(l[1]),v=k.nest(x,[D,"data-metaNest"])?[x]:[];else{y.nest=[D,"data-metaNest"];y.attr=[];for(h.lastIndex=0;null!==(l=h.exec(u));)l[2]=g[l[2]||""],y.attr.push(l);y.attr.length||(y.attr=0);y.attr||(d.lastIndex=0,l=d.exec(u),y.className=l?l[1]:l);f.lastIndex=0;l=(l=f.exec(u))?l[1]:"*";l=E?l:l.toUpperCase();y.tag=l; w=[];A=0;for(F=v.length;A<F;A++)if(x=v[A],z)w=w.concat(z(x,l,"data-metaNest",D,y,a,k));else for(d.lastIndex=0,(r=d.exec(u))&&x.getElementsByClassName?(B=x.getElementsByClassName(r[1]),r=0):B=x.getElementsByTagName(l),r||(y.className=0),r=0,G=B.length;r<G;r++)x=B[r],a(x,y,k)&&w.push(x);v=w}z=null;n[2]&&","==n[2].replace(/^\s+|\s+$/g,"")&&(H[I++]=v,v=[m])}H[I]=v;D=[];v=[];A=0;for(F=H.length;A<F;A++)for(B=H[A],r=0,G=B.length;r<G;r++)x=B[r],k.nest(x,[D,"data-metaNest"])&&v.push(x);return v}}();e.sandbox= function(){var a=document.createElement("iframe"),b,c;a.style.display="none";document.body.appendChild(a);c=frames[frames.length-1];b=c.document;b.writeln("<script>window.sandbox=window.ActiveXObject?this:{eval:function(s){return eval(s)}};\x3c/script>");b.close();return{eval:function(a){return c.sandbox.eval(a)},include:function(a){var c=b.createElement("script");c.src=a;b.body.appendChild(c)}}};e.dom=e(e.domevent).extend(function(){function a(a){"float"==a&&(a=w?"styleFloat":"cssFloat");return e.string.$(a).toCamelCase("-")} var b={before:function(a,b,c){c&&c.insertBefore(b,a)},after:function(a,b,c){c&&c.insertBefore(b,a.nextSibling)},replace:function(a,b,c){c&&c.replaceChild(b,a)},prepend:function(a,b){a.insertBefore(b,a.firstChild||null)},append:function(a,b){a.appendChild(b)}},c=e.string.$(),d=e.array.$(),h,f;return{info:{name:"Meta.dom"},_doc:document,$:function(){var a=["$"],b=arguments;b.length?a=a.concat(e.args2array(b)):a.push(this.doc());return this.$super.apply(this,a)},set:function(a,b){return this.$super("set", a||this.doc(),b)},doc:function(a){if(!a)return this._doc=this._doc||document;if(!e.its(a,"string"))return this._doc=9==a.nodeType?a:a.ownerDocument?a.ownerDocument:document,this;w?(this._doc=new ActiveXObject("Msxml2.DOMDocument"),this._doc.async=!1,this._doc.loadXML(a)):this._doc=(new DOMParser).parseFromString(a,"text/xml");this.set(e.obj2array(this._doc.childNodes));return this},select:function(a){var b=[],c=e.select;this.len()?this.forEach(function(d){b=b.concat(c(a,d))}):b=c(a,this.doc());return this.$(b)}, evalGlobal:function(a){var b=this.doc(),c=b.createElement("script"),d=b.getElementsByTagName("head")[0]||b.documentElement;c.type="text/javascript";w?c.text=a:c.appendChild(b.createTextNode(a));d.insertBefore(c,d.firstChild);d.removeChild(c);return this},glue:function(a,c){if(""===a)return this;var p,q=this,h=b[c||"append"],f=q.$(),l=d.$(),r=d.$();a.nodeType?f.set(a):"string"==typeof a?f=f.create(a):f.set(a);p=q.doc().createDocumentFragment();f.forEach(function(a){"script"==a.nodeName.toLowerCase()? l.push(a):1==a.nodeType&&l.concat(e.obj2array(a.getElementsByTagName("script")));p.appendChild(a)});l.forEach(function(a){a.src||(r.push(a.text||a.textContent||a.innerHTML||""),a.parentNode.removeChild(a))});r=r.join("\n");q.forEach(function(a,b){h(a,b?p.cloneNode(!0):p,a.parentNode);r&&q.evalGlobal(r)});return q},remove:function(){for(var a=this._,b=a.length,c;b--;)c=a[b],c.parentNode&&c.parentNode.removeChild(c);return this},create:function(a){var b=[],c,d=this.doc().createElement("div");c=e.string.$(a); var m,n;a=c.trim().get();m=c.substr(c.lastIndexOf("<"));n=m.indexOf(" ");0>n&&(n=m.indexOf(">"));m="|"+m.substr(2,n-2).get()+"|";0>c.set("|caption|colgroup|col|thead|tfoot|tbody|tr|th|td|").indexOf(m)&&(m=0);this.isXML(d)?(c=f,c||(h=e.sandbox(),c=f=h.eval('document.createElement("div");')),c.innerHTML=a,e.dom.copyNodes(c.childNodes,d)):(m&&(a="|tr|"==m?"<table><tbody>"+a+"</tbody></table>":c.set("|th|td|").indexOf(m)?"<table><tbody><tr>"+a+"</tr></tbody></table>":"<table>"+a+"</table>"),w?(d.innerHTML= m?a:"<br>"+a,d.removeChild(d.firstChild)):d.innerHTML=a,m&&(d=d.firstChild,"|tr|"==m?d=d.firstChild:c.set("|th|td|").indexOf(m)&&(d=d.firstChild.firstChild)));for(;c=d.firstChild;)b.push(d.removeChild(c));return this.$(b)},prop:function(a,b){return(b=this.get(b||0))?a in b?b[a]:null:b},attr:function(a,b){var c,d=this._;c=d.length;var e,f;if(!c)return null;e=d[0];f=e.attributes;if(!a)return f;if(void 0!==b){for(;c--;)null===b&&d[c].removeAttribute?d[c].removeAttribute(a):d[c].setAttribute(a,b);return this}return f? e.getAttribute(a):null},data:function(a,b){var c=this._,d=e.string.$(a).toCamelCase("-"),f=c.length;if(void 0===b)return f?c[0].dataset[d]:null;for(;f--;)c[f].dataset[d]=b;return this},css:function(b,c){var d=this._,e=d.length;b=a(b);if(void 0===c)return e?d[0].style[b]:null;for(;e--;)d[e].style[b]=c;return this},style:function(b,c){if(c=this.get(c||0))b=a(b),c=window.getComputedStyle?window.getComputedStyle(c,null).getPropertyValue(b):c.currentStyle[b];return c},val:function(a){var b,c=[],d,f=this._, h=f.length,l=e.indexOf;if(void 0!==a){for(;h--;)if(b=f[h],"SELECT"==b.nodeName)for(a.push||(a=[a]),d=b.options,b=d.length;b--;)c=d[b],c.selected=!1,-1<l(a,c.value,1)&&(c.selected=!0);else b.value=a;return this}if(!h)return null;a=f[0];if("SELECT"!=a.nodeName)return a.value||null;if(!a.multiple)return a.options[a.selectedIndex].value;a=a.options;for(b in a)a[b].selected&&c.push(a[b].value);return c},outer:function(a){var b=this._,c=b.length,d;a=b[a||0];if(!a||!a.nodeType)return null;if(3==a.nodeType)return a.nodeValue; if(!w){if(this.isXML(a))return(new XMLSerializer).serializeToString(a);b=this.doc().createElement("b");b.appendChild(a);return b.innerHTML}b=this.isXML(a)?"xml":"outerHTML";if(11!=a.nodeType)d=a[b];else{d=[];a=a.childNodes;for(c=a.length;c--;)d.push(a[c][b]);d.reverse();d=d.join("")}return d},inner:function(a,b){var c=this._,d,e="",f,h;if(void 0===a){if(!c.length)return null;d=c[0];if(!this.isXML(d))return d.innerHTML;c=this.$();d=d.childNodes;f=0;for(h=d.length;f<h;f++)e+=c.set(d[f]).outer();return e}this.empty().append(a, b);return this},text:function(a){if(void 0===a){a=this._;if(!a.length)return null;a=a[0];return a.text||a.textContent||(a.innerHTML?a.innerHTML.replace(/<\/?[^>]+>/gi,""):"")}this.empty().append(this.doc().createTextNode(a));return this},elements:function(a){var b=this._;if(!b.length)return null;var c=[],d=b[0];if("FORM"!=d.nodeName.toUpperCase())return null;d=d.elements;for(b=d.length;b--;)if(void 0===a)c.push(c[d[b].name]=d[b]);else if(d[b].name==a)return d[b];return a?null:c},submit:function(a){var b= this._;if(!b.length)return this;a=a||function(){};for(var c=this.elements(),d=this.$(),f=[],h=0,l,r,u;h<c.length;h++)u=c[h],"FIELDSET"!=u.nodeName.toUpperCase()&&("INPUT"!=u.nodeName.toUpperCase()||"checkbox"!=u.type.toLowerCase()&&"radio"!=u.type.toLowerCase()||u.checked)&&(l=d.set(u).val(),r=encodeURIComponent(u.name,1)+"=",e.its(l,"array")?e.each(l,function(a){f.push(r+encodeURIComponent(null===a||void 0===a?"":a,1))}):f.push(r+encodeURIComponent(null===l||void 0===l?"":l,1)));e.ajax({url:b[0].action, callbacks:a,method:"POST",data:f.join("&")});return this},nodes:function(a){var b=this._,c=[],d=b.length;a=a||0;if(d<=a)return null;d=b[a].childNodes;b=d.length;for(a=0;a<b;a++)1==d[a].nodeType&&c.push(d[a]);return c},empty:function(){for(var a,b=this._,c=b.length,d=this.isXML();c--;)if(a=b[c],d)for(;a.firstChild;)a.removeChild(a.firstChild);else a.innerHTML="";return this},hasClass:function(a,b){var c=this._,d=c.length;b=b||0;if(d<=b)return!1;b=c[b];return b.className?-1<(" "+b.className+" ").indexOf(" "+ a+" "):!1},addClass:function(a){for(var b=this._,e=b.length,f;e--;)f=b[e],"className"in f&&(f.className=c.set(d.set(f.className.split(" ")).insert(a).unique().get().join(" ")).trim().get());return this},rmClass:function(a){for(var b=this._,e=b.length,f,h,n;e--;)f=b[e],f.className&&(h=d.set(f.className.split(" ")).unique(),n=h.indexOf(a),-1<n&&(f.className=c.set(h.splice(n,1).get().join(" ")).trim().get()));return this},dims:function(a){if(a=this.get(a||0)){for(var b=a.offsetLeft||0,c=a.offsetTop|| 0,d=a.offsetWidth||0,e=a.offsetHeight||0;a=a.offsetParent;)b+=a.offsetLeft-a.scrollLeft+(a.clientLeft?a.clientLeft:0),c+=a.offsetTop-a.scrollTop+(a.clientTop?a.clientTop:0);a={left:b,top:c,width:d,height:e}}return a},scrollDims:function(a){return(a=this.get(a||0))?{left:a.scrollX||a.scrollLeft,top:a.scrollY||a.scrollTop,width:a.scrollWidth||0,height:a.scrollHeight||0}:a},opacity:function(a){var b=Math.round(100*a);return this.css("MozOpacity",a).css("opacity",a).css("KHTMLOpacity",a).css("zoom",1).css("filter", "alpha(opacity="+b+")")},hide:function(){return this.css("display","none")},show:function(a){return this.css("display",a||"")},parent:function(a){return this.$(this.prop("parentNode",a))},next:function(a){for(a=this.get(a||0);a&&(a=a.nextSibling)&&1!=a.nodeType;);return this.$(a)},prev:function(a){for(a=this.get(a||0);a&&(a=a.previousSibling)&&1!=a.nodeType;);return this.$(a)},first:function(a){for(a=this.prop("firstChild",a);a&&1!=a.nodeType;)a=a.nextSibling;return this.$(a)},last:function(a){for(a= this.prop("lastChild",a);a&&1!=a.nodeType;)a=a.previousSibling;return this.$(a)},value:function(a){return this.prop("nodeValue",a)},type:function(a){return this.prop("nodeType",a)},name:function(a){return this.prop("nodeName",a)},isXML:function(a){a||(a=this.doc());a=9==a.nodeType?a:a.ownerDocument;return"HTML"!==a.documentElement.nodeName}}}()).extend(function(){e.genProperties("prepend,append,before,after,replace",function(a){return function(b){return this.glue(b,a)}},this)}).extend(function(){var a= {prependTo:"prepend",appendTo:"append",insertBefore:"before",insertAfter:"after",replaceIn:"replace"};e.genProperties("prependTo,appendTo,insertBefore,insertAfter,replaceIn",function(b){return function(c){var d=this._;return this.set(c).glue(d,a[b]).set(d)}},this)});e.dom.copyNodes=function(a,b,c,d){var h=b.ownerDocument?b.ownerDocument:9==b.nodeType?b:document,f=function(a,b){for(var c,e=0,f=b.length;e<f;e++)1==b[e].nodeType?c=a.appendChild(g(b[e])):3==b[e].nodeType&&a.appendChild(h.createTextNode(b[e].nodeValue)), d==b[e]&&(d=c)},g=function(a){c&&a&&!a.id&&e.has(a,"uniqueID")&&(a.id=a.uniqueID);var b=e.dom.cloneTag(a);f(b,a.childNodes);return b};f(b,a);return d};e.dom.cloneTag=function(a,b){b=b||(a.ownerDocument?a.ownerDocument:document);var c=b.createElement(a.nodeName.toLowerCase()),d,e;d=a.attributes;for(e=d.length;e--;)c.setAttribute(d[e].name,d[e].value);return c};e.dom.cloneNode=function(a,b){b=b||(a.ownerDocument?a.ownerDocument:document);if(3==a.nodeType)return b.createTextNode(a.nodeValue);var c=e.dom.cloneTag(a, b);e.dom.copyNodes(a.childNodes,c);return c};e.dom.ready=function(){var a=0,b,c,d=e.events.$(),h;d.extend({fireReady:function(){a||(a=1,this.fireEvent("ready",window),c&&clearInterval(c))}});h=d.callback("fireReady");e.has(document,"addEventListener")?document.addEventListener("DOMContentLoaded",h,!1):e.has(window,"ActiveXObject")?(b=document.createElement("script"),b.onreadystatechange=function(){/loaded|complete/.test(b.readyState)&&(h(),b.onreadystatechange=null)},b.defer=!0,b.src="javascript:void(0);", document.getElementsByTagName("HEAD")[0].appendChild(b)):/Safari/i.test(navigator.userAgent)&&(c=setInterval(function(){/loaded|complete/.test(document.readyState)&&h()},10));e.dom.addEvent("load",window,h);return function(b){a?b():d.addEvent("ready",window,b)}}();e.dom.purge=function(a){if(w||a.attributes){var b=a.attributes,c,d;if(b)for(c=b.length;c--;)d=b[c].name,"function"===typeof a[d]&&(a[d]=null);if(b=a.childNodes)for(c=b.length;c--;)e.dom.purge(b[c])}};e.websocketevent=e(e.eventtarget).extend({valid_type:" open message error close "}); e.websocket=e(e.websocketevent).extend({connect:function(a){this.set(new WebSocket(a));this.fire("connect");return this},close:function(){var a=this.get();a&&a.close();this.fire("close");return this},send:function(a){a=JSON.stringify(a);var b=this.get();b&&b.send(a);this.fire("send",a);return this}});e.cookie=e(e.core).extend({create:function(a){var b=this.get()+"="+a.value,c;for(c in a)"value"!=c&&(b+=";"+c+"="+a[c]);document.cookie=b},read:function(){for(var a=document.cookie.split(";"),b,c=a.length;c--;)if(b= a[c].replace(/^\s*|\s*$/g,"").split("="),b[0]==this.get())return decodeURIComponent(b[1]);return null},erase:function(){var a=new Date;a.setDate(a.getDate()-9);this.create({value:"","max-age":0,expire:a.toUTCString()})}});e.popup=function(a){a=a||{};a.src=a.src||"";var b=b=window.open(a.src,a.name||(a.name="meta"+(new Date).getTime()),a.params||"");""==a.src&&b&&b.document&&(b.document.writeln(a.write||'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\n<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>'+ (a.title||a.name)+"</title></head><body></body></html>"),b.document.close());b||(b=null);return b};e.log=function(){var a=null,b=e.dom.$(),c=e.string.$(),d=e.dom.$();e.dom.addEvent("unload",window,function(){a&&!a.closed&&a.close()});return function(h){if(!a||a.closed)a=e.popup({title:"Meta.log",params:"width=400,height=400,location=0,menubar=0,status=0,toolbar=0,directories=0,personalbar=0,resizable=1,scrollbars=1,dependent=1"});if(!a||!a.document||!a.document.body||a.closed)return a=null;b.set(a.document.body).doc(a.document); b.append('<div style="border-bottom:1px solid #ccc;padding:4px;font-size:12px;font-family:arial;">'+c.set(h).trim().escapeHTML().nl2br().get()+"</div>");0>e.log.buff&&d.set(b.get().firstChild).doc(b.doc()).remove();a.scrollBy(0,b.dims().height);a.focus();return a}}();e.log.buff=100;e.assert=function(a,b){var c=e.assert;c.log&&e.log(a+" = "+b);if(!0!==b&&!1!==b)c.onfail("Unexpected value: "+b);if(b)c.onpass(a);else c.onfail(a)};e.assert.log=!1;e.assert.onfail=function(){};e.assert.onpass=function(){}; e.guiEngine=e(function(){function a(){"meta_sel"in m&&(q.css("MozUserSelect",m.meta_MozUserSelect),q.css("KhtmlUserSelect",m.meta_KhtmlUserSelect),q.get().onselectstart=m.meta_onselectstart,q.get().unselectable=m.meta_unselectable)}function b(){"meta_sel"in m||(m.meta_sel=1,m.meta_onselectstart=q.get().onselectstart,m.meta_unselectable=q.get().unselectable,m.meta_MozUserSelect=q.css("MozUserSelect"),m.meta_KhtmlUserSelect=q.css("KhtmlUserSelect"));q.get().onselectstart=function(){return!1};q.get().unselectable= "on";q.css("MozUserSelect","none").css("KhtmlUserSelect","none")}function c(a){if(!u||!g.len())return!1;a=a?a:window.event;var b=[a.screenX-r[0],a.screenY-r[1]];"mmv"in v[u]&&v[u].mmv(a,b);a.cancelBubble=!0;return!1}function d(a){a=a?a:window.event;g.set(a.target||a.srcElement);u=g.attr("gui");if(!(u in v))return!1;var b=g.attr("dad"),c=g.attr("limit");b&&g.select("#"+b);c?k.select("#"+c):k.set(q.get());f();"md"in v[u]&&v[u].md(a);r=[a.screenX,a.screenY];a.cancelBubble=!0;return!1}function h(a){if(!u)return!1; a=a?a:window.event;"mu"in v[u]&&v[u].mu(a);r=[a.screenX,a.screenY];a.cancelBubble=!0;u="";return!1}function f(){var a=k.dims();n=[a.left,a.top,t.width+a.left,t.height+a.top]}var g=e.dom.$(),k=e.dom.$(),p=e.domevent.$(document),q,m={},n=[0,0,0,0],l={left:0,top:0,width:0,height:0},r=[0,0],u="",z=0,v={drag:{md:function(a){l=g.dims();b();g.css("position","absolute").css("zIndex","1")},mu:function(b){a();g.css("zIndex","0")},mmv:function(a,b){var c=l,d=[n[2]-s[0],n[3]-s[1]];b=[c.left+b[0],c.top+b[1]]; b[0]>=n[0]&&b[0]<d[0]?(c.left=b[0],r[0]=a.screenX):b[0]<n[0]?b[0]=n[0]:b[0]>d[0]&&(b[0]=d[0]);b[1]>=n[1]&&b[1]<d[1]?(c.top=b[1],r[1]=a.screenY):b[1]<n[1]?b[1]=n[1]:b[1]>d[1]&&(b[1]=d[1]);g.css("left",b[0]+"px");g.css("top",b[1]+"px")}},resize:{md:function(a){b()},mu:function(b){a()},mmv:function(a,b){var c=g.dims();b=[c.width+b[0],c.height+b[1]];10<=b[0]&&(g.css("width",b[0]+"px"),r[0]=a.screenX);10<=b[1]&&(g.css("height",b[1]+"px"),r[1]=a.screenY)}}};return{guiStart:function(){z||(p.on("mousemove", c).on("mousedown",d).on("mouseup",h),z=1,q=e.dom.$().set(document.body),k.set(q.get()),f())},guiStop:function(){z&&(p.off("mousemove",c).off("mousedown",d).off("mouseup",h),z=0)},guiEngine:function(){return z}}}());e.animation=function(){function a(a,c,d,e,p,q){e=parseInt(e,10);var m=(new Date).getTime(),n=m+(e||200),l=d-c,r=n-m,u=this;b.addEvent("frameStep",b,function(){var a=(new Date).getTime();if(a>=n)return!1;p.call(q,c+(a-m)*l/r)});b.addEvent("stopAnim",b,function(){a&&a.call(u,q)});b.fireEvent("frameStep", b)}var b=e.events.$(),c=1E3/30,d="clip position width height left top display visibility overflow filter MozOpacity zoom opacity KHTMLOpacity".split(" ");b.onFireEvent=function(a,d){"frameStep"==a.type&&(d?setTimeout(b.callback("fireEvent","frameStep",b),c):(b.rmEvent("frameStep",b),b.fireEvent("stopAnim",b),b.rmEvent("stopAnim",b)))};return e.son({data_meta:"data-meta_",cssBackup:function(){var a=e.dom.$(),b,c=this;return c.forEach(function(k){a.set(k);k=parseInt(a.attr(c.data_meta+"bak"),10)||0; a.attr(c.data_meta+"bak",k+1);k||(e.each(d,function(d){b=a.css(d);null!==b&&a.attr(c.data_meta+d,b)}),a.attr(c.data_meta+"size_w")||(b=a.dims(),a.attr(c.data_meta+"size_w",b.width).attr(c.data_meta+"size_h",b.height)),a.attr(c.data_meta+"pos_l")||(b=a.dims(),a.attr(c.data_meta+"pos_l",b.left).attr(c.data_meta+"pos_t",b.top)))})},cssRestore:function(a){function b(a){k=c.attr(p.data_meta+a);c.css(a,"");null!==k&&c.css(a,k)}var c=e.dom.$(),k,p=this;return p.forEach(function(k){c.set(k).attr(p.data_meta+ "bak")&&(a?b(a):e.each(d,b))})},cssBackupClear:function(){var a=e.dom.$(),b=this;return b.forEach(function(c){a.set(c);e.each(d,function(c){a.attr(b.data_meta+c,null)});a.attr(b.data_meta+"bak",null).attr(b.data_meta+"size_w",null).attr(b.data_meta+"size_h",null).attr(b.data_meta+"pos_l",null).attr(b.data_meta+"pos_t",null)})},animate:function(c,d,e,k,p,q,m){var n=this;n.cssBackup();n.cssRestore("display");n.__||b.addEvent("stopAnim",b,function(){m&&(n.cssRestore(),n.cssBackupClear());n.__=0});n.__= 1;return this.forEach(function(b){k&&k(b);a.call(n,q,c.call(b),d.call(b),e,p,b)})}})}();e.inherit(e.animation,{clip:function(a,b,c){var d=e.dom.$(),h=this,f,g,k,p=function(){return 0},q=function(){return d.set(this).dims().width},m=function(){return d.set(this).dims().height},n=function(){return 1},l=function(a,b,c,e){d.css("clip","rect("+a+"px "+b+"px "+c+"px "+e+"px)")};[function(){f=p;g=m;k=function(a){d.set(this);var b=d.dims();l(a,b.width,b.height,0)}},function(){f=q;g=p;k=function(a){d.set(this); var b=d.dims();l(0,a,b.height,0)}},function(){f=m;g=p;k=function(a){d.set(this);var b=d.dims();l(0,b.width,a,0)}},function(){f=p;g=q;k=function(a){d.set(this);var b=d.dims();l(0,b.width,b.height,a)}},function(){f=p;g=m;k=function(a){d.set(this);var b=d.dims();l(a,b.width,b.height-a,0)}},function(){f=p;g=q;k=function(a){d.set(this);var b=d.dims();l(0,b.width-a,b.height,a)}},function(){f=p;g=n;k=function(a){d.set(this);var b=d.dims(),c=a*b.width;a*=b.height;l(a,b.width-c,b.height-a,c)}},function(){f= p;g=n;k=function(a){d.set(this);var b=d.dims();l(b.height*a,b.width-a*b.width,b.height,0)}},function(){f=p;g=n;k=function(a){d.set(this);var b=d.dims();l(0,b.width,b.height-b.height*a,a*b.width)}},function(){f=p;g=n;k=function(a){d.set(this);var b=d.dims();l(b.height*a,b.width,b.height,a*b.width)}},function(){f=p;g=n;k=function(a){d.set(this);var b=d.dims();l(0,b.width-a*b.width,b.height-b.height*a,0)}},function(){f=p;g=n;k=function(a){d.set(this);var b=d.dims(),c=b.height*a;l(c,b.width-a*b.width, b.height-c,0)}},function(){f=p;g=n;k=function(a){d.set(this);var b=d.dims(),c=a*b.width;l(b.height*a,b.width-c,b.height,c)}},function(){f=p;g=n;k=function(a){d.set(this);var b=d.dims(),c=b.height*a;l(c,b.width,b.height-c,a*b.width)}},function(){f=p;g=n;k=function(a){d.set(this);var b=d.dims(),c=a*b.width;l(0,b.width-c,b.height-b.height*a,c)}}][a]();return this.animate(f,g,b,function(a){d.set(a).css("overflow","hidden").css("position","absolute")},k,function(a){d.set(a).hide();c&&c.call(h,a)})}}); e.inherit(e.animation,{fade:function(a,b,c){var d=this,h=e.dom.$(),f,g;f=function(){return 0};var k=function(){return 1},p=function(a){c&&c.call(d,a)},q=function(a){h.set(a).hide();c&&c.call(d,a)};"out"==a?(a=k,p=q):(a=f,f=k,g=1);return this.animate(a,f,b,null,function(a){h.set(this).opacity(a)},p,g)}});e.inherit(e.animation,{slide:function(a,b,c){var d=this,h=e.dom.$(),f,g,k,p,q=function(){return 0},m=function(){return h.set(this).dims().width},n=function(){return h.set(this).dims().height},l=function(){return 1}, r=function(a){h.set(this).css("width",a+"px")},u=function(a){h.set(this).css("height",a+"px")},w=function(a){h.set(this);var b=[h.attr(d.data+"size_w"),h.attr(d.data+"size_h")];h.css("width",a*b[0]+"px").css("height",a*b[1]+"px")},v=function(a){c&&c.call(d,a)},C=function(a){h.set(a).hide();c&&c.call(d,a)};({"up-left":function(){f=l;g=q;k=w;v=C},right:function(){f=q;g=m;k=r;p=1},left:function(){f=m;g=q;k=r;v=C},up:function(){f=n;g=q;k=u;v=C},down:function(){f=q;g=n;k=u;p=1},"down-right":function(){f= q;g=l;k=w;p=1}})[a]();return d.animate(f,g,b,function(a){h.set(a).css("overflow","hidden")},k,v,p)}});e.dom.extend(e.animation)})(window);
